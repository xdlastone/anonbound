local player = game.Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")
local TweenService = game:GetService("TweenService")
local UIS = game:GetService("UserInputService")
local StarterGui = game:GetService("StarterGui")
local Lighting = game:GetService("Lighting")

-- [[ CONFIGURATION: COLORS ]] --
local C_BG       = Color3.fromHex("#14141e") 
local C_HEADER   = Color3.fromHex("#1c1c2b") 
local C_ACCENT   = Color3.fromHex("#c72d80") 
local C_TEXT     = Color3.fromHex("#ffffff") 
local C_TEXT_DIM = Color3.fromHex("#7e7e8c") 
local C_STROKE   = Color3.fromHex("#2d2d3d") 
local C_CARD_BG  = Color3.fromHex("#1e1e29")
local C_CARD_GRADIENT_BOTTOM = Color3.fromHex("#2a2a35") -- Для градиента уведомлений

-- [[ BLUR SETUP ]] --
local blurEffect = Instance.new("BlurEffect")
blurEffect.Name = "AnonboundBlur"
blurEffect.Size = 0 
blurEffect.Parent = Lighting

-- [[ MAIN SCREEN GUI ]] --
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "WakeUI"
screenGui.ResetOnSpawn = false 
screenGui.Parent = playerGui

-- ============================================================================
-- [[ NOTIFICATION SYSTEM INTEGRATION ]]
-- ============================================================================

-- Контейнер для уведомлений (Справа сверху)
local NotifHolder = Instance.new("Frame")
NotifHolder.Name = "NotificationHolder"
NotifHolder.Parent = screenGui -- Важно: крепим к ScreenGui, а не к MainFrame
NotifHolder.BackgroundTransparency = 1
NotifHolder.AnchorPoint = Vector2.new(1, 0) 
NotifHolder.Position = UDim2.new(1, -20, 0, 20) 
NotifHolder.Size = UDim2.new(0, 330, 0.8, 0) 

local NotifList = Instance.new("UIListLayout")
NotifList.Parent = NotifHolder
NotifList.SortOrder = Enum.SortOrder.LayoutOrder
NotifList.Padding = UDim.new(0, 10) 
NotifList.HorizontalAlignment = Enum.HorizontalAlignment.Right
NotifList.VerticalAlignment = Enum.VerticalAlignment.Top

-- Функция отправки уведомления
local function SendNotification(title, text, duration)
    duration = duration or 5
    
    local Container = Instance.new("Frame")
    Container.Name = "NotifContainer"
    Container.Parent = NotifHolder
    Container.BackgroundTransparency = 1
    Container.Size = UDim2.new(1, 0, 0, 55) 
    
    local Card = Instance.new("Frame")
    Card.Name = "Card"
    Card.Parent = Container
    Card.BackgroundColor3 = Color3.new(1, 1, 1)
    Card.Size = UDim2.new(1, 0, 1, 0)
    Card.Position = UDim2.new(1.5, 0, 0, 0) 
    
    -- Градиент
    local Gradient = Instance.new("UIGradient")
    Gradient.Rotation = 90
    Gradient.Color = ColorSequence.new{
        ColorSequenceKeypoint.new(0, C_CARD_BG),
        ColorSequenceKeypoint.new(1, C_CARD_GRADIENT_BOTTOM)
    }
    Gradient.Parent = Card

    -- Скругление и обводка
    local UICorner = Instance.new("UICorner")
    UICorner.CornerRadius = UDim.new(0, 8)
    UICorner.Parent = Card
    
    local UIStroke = Instance.new("UIStroke")
    UIStroke.Color = C_STROKE
    UIStroke.Thickness = 1.5
    UIStroke.Parent = Card
    
    -- Акцентная линия
    local AccentBar = Instance.new("Frame")
    AccentBar.BackgroundColor3 = C_ACCENT
    AccentBar.Size = UDim2.new(0, 4, 0, 40)
    AccentBar.Position = UDim2.new(0, 0, 0.5, 0)
    AccentBar.AnchorPoint = Vector2.new(0, 0.5)
    AccentBar.BorderSizePixel = 0
    AccentBar.Parent = Card
    
    local BarCorner = Instance.new("UICorner") 
    BarCorner.CornerRadius = UDim.new(0, 4)
    BarCorner.Parent = AccentBar
    
    -- Тексты
    local TitleLabel = Instance.new("TextLabel")
    TitleLabel.Parent = Card
    TitleLabel.BackgroundTransparency = 1
    TitleLabel.Position = UDim2.new(0, 15, 0, 8)
    TitleLabel.Size = UDim2.new(1, -20, 0, 20)
    TitleLabel.Font = Enum.Font.GothamBold
    TitleLabel.Text = title
    TitleLabel.TextColor3 = C_TEXT
    TitleLabel.TextSize = 14
    TitleLabel.TextXAlignment = Enum.TextXAlignment.Left
    TitleLabel.ZIndex = 2
    
    local TextLabel = Instance.new("TextLabel")
    TextLabel.Parent = Card
    TextLabel.BackgroundTransparency = 1
    TextLabel.Position = UDim2.new(0, 15, 0, 28)
    TextLabel.Size = UDim2.new(1, -20, 0, 35)
    TextLabel.Font = Enum.Font.Gotham
    TextLabel.Text = text
    TextLabel.TextColor3 = C_TEXT_DIM
    TextLabel.TextSize = 13 -- Чуть уменьшил для вместимости
    TextLabel.TextWrapped = true
    TextLabel.TextXAlignment = Enum.TextXAlignment.Left
    TextLabel.TextYAlignment = Enum.TextYAlignment.Top
    TextLabel.ZIndex = 2
    
    -- Анимация
    local infoIn = TweenInfo.new(0.6, Enum.EasingStyle.Exponential, Enum.EasingDirection.Out)
    local infoOut = TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.In)
    
    local tweenIn = TweenService:Create(Card, infoIn, {Position = UDim2.new(0, 0, 0, 0)})
    tweenIn:Play()
    
    task.spawn(function()
        task.wait(duration) 
        if Card and Card.Parent then
            local tweenOut = TweenService:Create(Card, infoOut, {Position = UDim2.new(1.5, 0, 0, 0)})
            tweenOut:Play()
            tweenOut.Completed:Wait() 
        end
        if Container then Container:Destroy() end
    end)
end

-- ============================================================================
-- [[ MAIN INTERFACE BODY ]]
-- ============================================================================

local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Size = UDim2.new(0, 0, 0, 0) -- Старт с 0 для анимации
mainFrame.Position = UDim2.new(0.5, 0, 0.5, 0)
mainFrame.BackgroundColor3 = C_BG
mainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
mainFrame.Active = true
mainFrame.ClipsDescendants = true 
mainFrame.Visible = false
mainFrame.Parent = screenGui

-- Add Stroke (Outline)
local mainStroke = Instance.new("UIStroke")
mainStroke.Color = C_STROKE
mainStroke.Thickness = 1
mainStroke.Parent = mainFrame

local mainCorner = Instance.new("UICorner")
mainCorner.CornerRadius = UDim.new(0, 8)
mainCorner.Parent = mainFrame

-- [[ HEADER SECTION ]] --
local headerFrame = Instance.new("Frame")
headerFrame.Name = "Header"
headerFrame.Size = UDim2.new(1, 0, 0, 60)
headerFrame.Position = UDim2.new(0, 0, 0, 0)
headerFrame.BackgroundColor3 = C_HEADER
headerFrame.BorderSizePixel = 0
headerFrame.Parent = mainFrame

local headerCorner = Instance.new("UICorner")
headerCorner.CornerRadius = UDim.new(0, 8)
headerCorner.Parent = headerFrame

local headerPatch = Instance.new("Frame")
headerPatch.Size = UDim2.new(1, 0, 0, 10)
headerPatch.Position = UDim2.new(0, 0, 1, -10)
headerPatch.BackgroundColor3 = C_HEADER
headerPatch.BorderSizePixel = 0
headerPatch.Parent = headerFrame

-- Title
local title = Instance.new("TextLabel")
title.Size = UDim2.new(0, 200, 1, 0)
title.Position = UDim2.new(0, 45, 0, 0)
title.BackgroundTransparency = 1
title.Text = "Anonbound"
title.TextColor3 = C_TEXT
title.Font = Enum.Font.GothamBold
title.TextSize = 24
title.TextXAlignment = Enum.TextXAlignment.Left
title.Parent = headerFrame

-- Version
local version = Instance.new("TextLabel")
version.Size = UDim2.new(0, 100, 1, 0)
version.Position = UDim2.new(0, 190, 0, 2)
version.BackgroundTransparency = 1
version.Text = "Alpha [v1.0.0]"
version.TextColor3 = C_TEXT_DIM
version.Font = Enum.Font.GothamBold
version.TextSize = 14
version.TextXAlignment = Enum.TextXAlignment.Left
version.Parent = headerFrame

-- Custom Accent Element
local accentBar = Instance.new("Frame")
accentBar.Size = UDim2.new(0, 4, 0, 24)
accentBar.Position = UDim2.new(0, 30, 0.5, -12)
accentBar.BackgroundColor3 = C_ACCENT
accentBar.BorderSizePixel = 0
accentBar.Parent = headerFrame
local accentCorner = Instance.new("UICorner")
accentCorner.CornerRadius = UDim.new(0, 4)
accentCorner.Parent = accentBar

-- [[ USER PROFILE (RIGHT HEADER) ]] --
local profileContainer = Instance.new("Frame")
profileContainer.Name = "UserProfile"
profileContainer.Size = UDim2.new(0, 135, 0, 36)
profileContainer.AnchorPoint = Vector2.new(1, 0.5) 
profileContainer.Position = UDim2.new(1, -15, 0.5, 0) 
profileContainer.BackgroundColor3 = C_BG 
profileContainer.BorderSizePixel = 0
profileContainer.Parent = headerFrame

local profileCorner = Instance.new("UICorner")
profileCorner.CornerRadius = UDim.new(0.2, 0)
profileCorner.Parent = profileContainer

local profileStroke = Instance.new("UIStroke")
profileStroke.Color = C_STROKE
profileStroke.Thickness = 1
profileStroke.Parent = profileContainer

-- Avatar
local avatarImage = Instance.new("ImageLabel")
avatarImage.Name = "Avatar"
avatarImage.Size = UDim2.new(0, 28, 0, 28)
avatarImage.Position = UDim2.new(0, 4, 0.5, 0) 
avatarImage.AnchorPoint = Vector2.new(0, 0.5)
avatarImage.BackgroundColor3 = C_CARD_BG
avatarImage.BackgroundTransparency = 1
avatarImage.Image = "rbxthumb://type=AvatarHeadShot&id=" .. player.UserId .. "&w=150&h=150"
avatarImage.Parent = profileContainer

local avatarCorner = Instance.new("UICorner")
avatarCorner.CornerRadius = UDim.new(1, 0)
avatarCorner.Parent = avatarImage

-- Username
local nameLabel = Instance.new("TextLabel")
nameLabel.Name = "Username"
nameLabel.Size = UDim2.new(1, -40, 1, 0)
nameLabel.Position = UDim2.new(0, 38, 0, 0)
nameLabel.BackgroundTransparency = 1
nameLabel.Text = player.Name 
nameLabel.TextColor3 = C_TEXT
nameLabel.Font = Enum.Font.GothamMedium
nameLabel.TextSize = 13
nameLabel.TextXAlignment = Enum.TextXAlignment.Left
nameLabel.Parent = profileContainer


-- [[ LINES & BODY ]] --
local line2 = Instance.new("Frame")
line2.Size = UDim2.new(1, 0, 0, 1)
line2.Position = UDim2.new(0, 0, 0, 60)
line2.BackgroundColor3 = C_STROKE
line2.BorderSizePixel = 0
line2.Parent = mainFrame

local line = Instance.new("Frame")
line.Size = UDim2.new(0, 1, 1, -60)
line.Position = UDim2.new(0, 240, 0, 60)
line.BackgroundColor3 = C_STROKE
line.BorderSizePixel = 0
line.Parent = mainFrame

local line3 = Instance.new("Frame")
line3.Size = UDim2.new(0, 1, 1, -60)
line3.Position = UDim2.new(0, 482, 0, 60)
line3.BackgroundColor3 = C_STROKE
line3.BorderSizePixel = 0
line3.Parent = mainFrame

-- Function Box
local functBox = Instance.new("Frame")
functBox.Size = UDim2.new(0, 240, 1, -60)
functBox.Position = UDim2.new(0, 242, 0, 60)
functBox.BackgroundColor3 = C_CARD_BG 
functBox.BackgroundTransparency = 1 
functBox.BorderSizePixel = 0
functBox.Parent = mainFrame


--[[ SMOOTH DRAG SYSTEM ]]
local dragging, dragInput, dragStart, startPos
local DRAG_SPEED = 0.15

local function update(input)
    if not mainFrame or not mainFrame.Parent then return end
    local delta = input.Position - dragStart
    local targetPos = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    TweenService:Create(mainFrame, TweenInfo.new(DRAG_SPEED, Enum.EasingStyle.Sine), {Position = targetPos}):Play()
end

mainFrame.InputBegan:Connect(function(input)
    if (input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch) then
        dragging = true
        dragStart = input.Position
        startPos = mainFrame.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then dragging = false end
        end)
    end
end)

mainFrame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
        dragInput = input
    end
end)

UIS.InputChanged:Connect(function(input)
    if input == dragInput and dragging then update(input) end
end)


--[[ SYSTEM: ANIMATION & DESTRUCT ]]
local isMenuOpen = false
local isAnimating = false
local OPEN_SIZE = UDim2.new(0, 900, 0, 600)
local CLOSED_SIZE = UDim2.new(0, 0, 0, 0)

-- Функция анимации открытия/закрытия
local function toggleMenu()
    if isAnimating or not mainFrame or not mainFrame.Parent then return end
    isAnimating = true

    if isMenuOpen then
        -- Close Animation (UI + Blur)
        TweenService:Create(blurEffect, TweenInfo.new(0.4, Enum.EasingStyle.Sine), {Size = 0}):Play() 
        local tween = TweenService:Create(mainFrame, TweenInfo.new(0.4, Enum.EasingStyle.Quart, Enum.EasingDirection.In), {Size = CLOSED_SIZE})
        tween:Play()
        tween.Completed:Wait()
        if mainFrame then mainFrame.Visible = false end
        isMenuOpen = false
    else
        -- Open Animation (UI + Blur)
        if mainFrame then mainFrame.Visible = true end
        TweenService:Create(blurEffect, TweenInfo.new(0.5, Enum.EasingStyle.Sine), {Size = 24}):Play() 
        local tween = TweenService:Create(mainFrame, TweenInfo.new(0.5, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {Size = OPEN_SIZE})
        tween:Play()
        isMenuOpen = true
    end
    
    isAnimating = false
end

-- Обработчик клавиш
local inputConnection
inputConnection = UIS.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end 

    -- [HOME] -> Toggle
    if input.KeyCode == Enum.KeyCode.Home then
        toggleMenu()

    -- [INSERT] -> Uninject
    elseif input.KeyCode == Enum.KeyCode.Insert then
        -- 1. Сначала уведомление
        SendNotification("System", "Uninjecting software...", 3)
        
        -- 2. Убираем обработчик ввода сразу, чтобы не нажать второй раз
        if inputConnection then inputConnection:Disconnect() end

        -- 3. Ждем секунду, чтобы увидеть уведомление, затем удаляем всё
        task.delay(1, function()
            if blurEffect then blurEffect:Destroy() end
            if screenGui then screenGui:Destroy() end
        end)
    end
end)

-- Initial Open
toggleMenu()

-- Custom Notification at Start
SendNotification("Anonbound", "Welcome, " .. player.Name .. "! Press [Home] to toggle.", 5)
