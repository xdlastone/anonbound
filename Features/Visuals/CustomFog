-- [[ CONFIGURATION ]] 
-- Настройки атмосферы (Night / Dim Mode)
local C_FOG           = Color3.fromHex("#18181c") -- Темно-серый туман
local C_AMBIENT       = Color3.fromHex("#2a2a30") -- Темные тени
local C_OUTDOOR       = Color3.fromHex("#1a1a20") -- Темное внешнее освещение

local FOG_END         = 300   -- Дальность прорисовки
local FOG_START       = 0     -- Начало тумана
local BRIGHTNESS      = 0.5   -- Пониженная яркость

-- Services
local RunService = game:GetService("RunService")
local Lighting = game:GetService("Lighting")

-- Хранилище оригинальных настроек
local originalSettings = {
    FogColor = Lighting.FogColor,
    FogStart = Lighting.FogStart,
    FogEnd = Lighting.FogEnd,
    Ambient = Lighting.Ambient,
    OutdoorAmbient = Lighting.OutdoorAmbient,
    Brightness = Lighting.Brightness,
    GlobalShadows = Lighting.GlobalShadows
}

-- Функция включения
local function ApplyCustomFog()
    Lighting.FogColor = C_FOG
    Lighting.FogStart = FOG_START
    Lighting.FogEnd = FOG_END
    Lighting.Ambient = C_AMBIENT
    Lighting.OutdoorAmbient = C_OUTDOOR
    Lighting.Brightness = BRIGHTNESS
    Lighting.GlobalShadows = true
end

-- Функция восстановления
local function RestoreSettings()
    Lighting.FogColor = originalSettings.FogColor
    Lighting.FogStart = originalSettings.FogStart
    Lighting.FogEnd = originalSettings.FogEnd
    Lighting.Ambient = originalSettings.Ambient
    Lighting.OutdoorAmbient = originalSettings.OutdoorAmbient
    Lighting.Brightness = originalSettings.Brightness
    Lighting.GlobalShadows = originalSettings.GlobalShadows
end

-- Включаем сразу при запуске скрипта
ApplyCustomFog()

-- Loop для поддержания настроек (чтобы игра не сбросила их)
local connection = RunService.RenderStepped:Connect(function()
    if Lighting.FogEnd ~= FOG_END or Lighting.Brightness ~= BRIGHTNESS then
        ApplyCustomFog()
    end
end)

-- [[ ВОЗВРАЩАЕМ CLEANUP ]]
-- Эта функция вызовется твоим GUI, когда ты нажмешь кнопку выключения
return function()
    if connection then connection:Disconnect() end
    RestoreSettings()
end
